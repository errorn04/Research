#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int check_auth( char *pass );

int main( int argc, char **argv ) {
	
	char *access_granted_msg = "[*] Access Granted \n";
	
	if( argc != 2 ) {
		
		printf("[!] Usage: %s <password> \n", argv[0] );
		exit(1);
		
	}
	
	if( check_auth( argv[1] ) ) {

		printf("%s", access_granted_msg);
		
		// Print the location in memory
		printf("[*] Location in memory: %p \n", access_granted_msg );
		
	} else {

		printf("[!] Access denied \n");
	
	}			

}

int check_auth( char *pass ) {
	
	char pass_buff[16]; // fixed buffer size
	int auth_flag = 0;
	
	// Copy pass to pass_buff
	strcpy( pass_buff, pass );
	
	// Now compare to see what was inputted is valid
	if( strcmp(pass_buff, "brilling" ) == 0 )
		auth_flag = 1;
		
	if( strcmp( pass_buff, "outgrabe" ) == 0 )
		auth_flag = 1;
		
return auth_flag;
}
